<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Q&A Viewer - Soft Rose</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

<style>
  .katex { margin: 0 0.25rem; }
  .fade { transition: opacity 0.2s ease-in-out; }
</style>
</head>
<body class="bg-rose-50 min-h-screen flex items-center justify-center p-6">

<div class="w-full max-w-5xl bg-white border border-rose-200 rounded-2xl shadow-lg p-8 space-y-6">

  <!-- Question -->
  <div id="question" class="text-center text-rose-700 text-2xl font-semibold"></div>

  <!-- Solution -->
  <div id="solutionArea" class="bg-fuchsia-50 text-fuchsia-800 p-6 rounded-xl min-h-[220px] text-lg leading-relaxed whitespace-pre-wrap fade">
    Click “Next” to start the solution.
  </div>

  <!-- Navigation -->
  <div class="flex justify-between items-center">
    <button id="prevBtn" class="px-4 py-2 bg-rose-400 text-white rounded-md hover:bg-rose-500 disabled:opacity-50" disabled>Previous</button>
    <button id="nextBtn" class="px-4 py-2 bg-fuchsia-500 text-white rounded-md hover:bg-fuchsia-600">Next</button>
  </div>

  <!-- Prompt Box -->
  <div id="promptPanel" class="bg-pink-50 border border-pink-200 rounded-xl p-4 space-y-4">
    <div class="flex justify-between items-center">
      <div class="flex items-center gap-2">
        <label class="text-sm text-gray-700">Text color:</label>
        <select id="colorSelect" class="border border-pink-300 rounded-md px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-pink-300">
          <option value="text-teal-800">teal</option>
          <option value="text-purple-700">Purple</option>
          <option value="text-red-700">red</option>
        </select>
        <button id="clearNotes" class="px-3 py-1 bg-pink-400 text-white rounded-md hover:bg-pink-500 text-sm">Clear</button>
      </div>
    </div>

    <textarea id="promptInput" rows="6" placeholder="Write your notes here..." class="w-full text-2xl text-center justify-center p-3 border border-pink-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-300 text-gray-800"></textarea>
  </div>

</div>

<script>
 const data = {
  question: "Evaluate $S_n = \\sum_{k=0}^{n} \\dfrac{k\\binom{n}{k}}{2^{k}}.$",
  steps: [
    "Start from the binomial expansion: $$ (1+x)^n = \\sum_{k=0}^{n} \\binom{n}{k} x^k $$",
    "Differentiate both sides with respect to $x$: $$ n(1+x)^{n-1} = \\sum_{k=0}^{n} k\\binom{n}{k} x^{k-1} $$",
    "Multiply both sides by $x$ to align powers: $$ n x(1+x)^{n-1} = \\sum_{k=0}^{n} k\\binom{n}{k} x^{k} $$",
    "We need $S_n = \\sum_{k=0}^{n} k\\binom{n}{k} \\left(\\dfrac{1}{2}\\right)^{k}$, which is the RHS at $x = \\dfrac{1}{2}$: $$ S_n = n x(1+x)^{n-1}\\Big|_{x=1/2} $$",
    "Substitute $x = \\dfrac{1}{2}$: $$ S_n = n\\cdot\\dfrac{1}{2}\\left(1+\\dfrac{1}{2}\\right)^{n-1} = n\\cdot\\dfrac{1}{2}\\left(\\dfrac{3}{2}\\right)^{n-1} $$",
    "Simplify powers: $$ S_n = n\\cdot\\dfrac{1}{2}\\cdot\\dfrac{3^{n-1}}{2^{n-1}} = n\\cdot\\dfrac{3^{n-1}}{2^{n}} $$",
    "Hence the closed form is: $$ \\boxed{S_n = \\dfrac{n\\,3^{n-1}}{2^{n}}} $$",
    "Quick check for small $n$: For $n=1$, $$S_1 = \\sum_{k=0}^{1} \\dfrac{k\\binom{1}{k}}{2^k} = 0 + \\dfrac{1}{2} = \\dfrac{1}{2}.$$ RHS: $$\\dfrac{1\\cdot 3^{0}}{2^{1}} = \\dfrac{1}{2}.$$ Verified ✅"
  ]
}


const q = document.getElementById("question")
const s = document.getElementById("solutionArea")
const next = document.getElementById("nextBtn")
const prev = document.getElementById("prevBtn")
const promptInput = document.getElementById("promptInput")
const colorSelect = document.getElementById("colorSelect")
const clearNotes = document.getElementById("clearNotes")

let step = -1

function renderMath(text) {
  const inline = /\$([^\$]+)\$/g
  const block = /\$\$([\s\S]+?)\$\$/g
  return text
    .replace(block, (_, exp) => katex.renderToString(exp, { displayMode: true }))
    .replace(inline, (_, exp) => katex.renderToString(exp, { displayMode: false }))
}

function showQuestion() {
  q.innerHTML = renderMath(data.question)
}

function showStep(index) {
  if (index < 0 || index >= data.steps.length) return
  step = index
  s.classList.add("opacity-0")
  setTimeout(() => {
    s.innerHTML = renderMath(data.steps[step])
    s.classList.remove("opacity-0")
  }, 150)
  prev.disabled = step === 0
  next.disabled = step === data.steps.length - 1
}

next.addEventListener("click", () => {
  if (step < data.steps.length - 1) showStep(step + 1)
})
prev.addEventListener("click", () => {
  if (step > 0) showStep(step - 1)
})

colorSelect.addEventListener("change", () => {
  promptInput.className = `w-full text-2xl text-center justify-center p-3 border border-pink-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-300 ${colorSelect.value}`
})

clearNotes.addEventListener("click", () => {
  promptInput.value = ""
})

document.addEventListener("DOMContentLoaded", () => {
  showQuestion()
})
</script>

</body>
</html>
